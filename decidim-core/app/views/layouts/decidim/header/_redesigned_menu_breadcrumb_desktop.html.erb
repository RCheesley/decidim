<div class="flex items-center">
  <%= link_to decidim.root_url, class: "menu-bar__breadcrumb-desktop__dropdown-trigger" do %>
    <%= icon "home-2-line" %><span class="sr-only"><%= t("decidim.menu.home") %></span>
  <% end %>
  <button id="main-dropdown-summary" class="menu-bar__breadcrumb-desktop__dropdown-trigger" data-component="dropdown" data-hover="true" data-target="main-dropdown-menu">
    <%= icon "arrow-drop-down-line" %><span class="sr-only"><%= t("layouts.decidim.header.main_menu") %></span>
  </button>
</div>

<script>
  // NOTE: This hack is very specific and exclusively related with #main-dropdown-menu, see https://github.com/decidim/decidim/pull/11253
  // that's why is placed next along with the dropdown itself
  document.addEventListener("DOMContentLoaded", () => {
    const mainDropdownMenu = document.getElementById("main-dropdown-menu")
    mainDropdownMenu.addEventListener("transitionend", ({ target }) => { target.allowReopen = false; target.style.pointerEvents = "none" })
    mainDropdownMenu.addEventListener("transitionstart", ({ target }) => { target.allowReopen = true; target.style.pointerEvents = "auto" })
    mainDropdownMenu.addEventListener("mouseenter", ({ target }) => target.allowReopen && target.getAttribute('aria-hidden') === 'true' && document.querySelector('#main-dropdown-summary').click())
  })
</script>

<div id="main-dropdown-menu" class="menu-bar__breadcrumb-desktop__dropdown-content" aria-hidden="true">
  <%= render partial: "layouts/decidim/header/redesigned_menu_breadcrumb_main_dropdown", locals: { id: "breadcrumb-main-dropdown-desktop" } %>
</div>

<%= render partial: "layouts/decidim/header/redesigned_menu_breadcrumb_items" %>
